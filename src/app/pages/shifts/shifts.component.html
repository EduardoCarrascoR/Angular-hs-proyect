<div class="row" materialize [formGroup]="shiftsForm" ngNativeValidate>
  <div class="col m12">
    <h3 class="hs-text-color">Turnos</h3>
  </div>
  <div class="row">
    <div class="col m4">
      <nav class="hs-color">
        <div class="nav-wrapper">
          <div class="col s12">
            <a routerLink="/dashboard/home" class="breadcrumb">Inicio</a>
            <a routerLink="/dashboard/shifts" class="breadcrumb">Turnos</a>
          </div>
        </div>
      </nav>
    </div>
    <div class="input-field col s12 m3 card card-input hoverable no-margin valign-wrapper right">
      <i class="material-icons prefix">list</i>
      <input id="icon_prefix" placeholder="Cantidad turnos" formControlName="limit" list="limit" type="text" class="validate card-input">
      <datalist id="limit">
        <option value="10">10 turnos</option>
        <option value="15">15 turnos</option>
        <option value="20">20 turnos</option>
      </datalist>
    </div>
  <div *ngIf="$shifts | loading | async as shiftsData;">
    <!-- clients data -->
    <ng-template [ngIf]="shiftsData.value">
      <div>
        <div class="col m12">
          <div class="card-panel no-padding">
            <table class="striped">
              <thead class="hs-color">
                <tr>
                  <th class="white-text min-width">Tipo</th>
                  <th class="white-text min-width">Fecha</th>
                  <th class="white-text max-width">Inicio</th>
                  <th class="white-text max-width">Termino</th>
                  <th class="white-text max-width">Locacion</th>
                  <th class="white-text max-width">Cliente</th>
                  <th class="white-text min-width">Guardias</th>
                  <th class="white-text min-width">Novedades</th>
                  <th class="white-text min-width">Visitas</th>
                  <th class="white-text min-width">Descargar</th>
                </tr>
              </thead>

              <tbody>
                <tr *ngFor="let shift of shiftsData.value.shifts">
                  <!-- <pre>{{ shift | json }}</pre> -->
                  <td *ngIf="shift.type === 'Day'" class="min-width">Día</td>
                  <td *ngIf="shift.type === 'Night'" class="min-width">Noche</td>
                  <td class="min-width">{{(shift.date | date: 'shortDate' )}}</td>
                  <td class="max-width">{{('2020-12-31:' + shift.start) | date: 'shortTime'}}</td>
                  <td class="max-width">{{('2020-12-31:' + shift.finish) | date: 'shortTime'}}</td>
                  <td class="max-width">{{(shift.shiftPlace || '')}}</td>
                  <td class="max-width">{{(shift.clientClient.name || '')}}</td>
                  <!-- Modal Trigger -->
                  <td class="min-width">
                    <a class="btn-flat valign-wrapper" (click)="openModal(shift.guards)">
                      <div class="row valign-wrapper">
                        <i class=" material-icons hs-text-color" id="icon">assignment_ind</i>
                        <h6 class=" hs-text-color">{{(shift.news).length+1}}</h6>
                      </div>
                    </a>
                  </td>
                  <td class="min-width ">
                    <a *ngIf="shift.news.length" class="btn-flat" (click)="openModalNews(shift.news)">
                      <div class="valign-wrapper">
                        <i class="material-icons hs-text-color" id="icon">assignment</i>
                        <h6 class="hs-text-color">{{(shift.news).length+1}}</h6>
                      </div>
                    </a>
                    <a *ngIf="!shift.news.length" class="btn-flat disabled">
                      <i class="material-icons hs-cruz-color" id="icon">cancel</i>
                    </a>
                  </td>
                  <td class="min-width">
                    <a *ngIf="shift.visits.length" class="btn-flat" (click)="openModalVisits(shift.visits)">
                      <div class="valign-wrapper">
                        <i class="material-icons hs-text-color" id="icon">directions_walk</i>
                        <h6 class="hs-text-color">{{(shift.visits).length+1}}</h6>
                      </div>
                      
                    </a>
                    <a *ngIf="!shift.visits.length" class="btn-flat disabled">
                      <i class="material-icons hs-cruz-color" id="icon">cancel</i>
                    </a>
                  </td>
                  <td class="min-width">
                    <a class="btn-flat" (click)="download()">
                      <i class="material-icons hs-text-color" id="icon">get_app</i>
                    </a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <ul class="pagination card-panel center">
            <div *ngIf="actualPage==1; then chevron_leftDisableBlock; else chevron_leftEnableBlock"></div>
            <ng-template #chevron_leftDisableBlock><li class="waves-effect disabled"><a><i class="material-icons">chevron_left</i></a></li></ng-template>
            <ng-template #chevron_leftEnableBlock><li (click)="chargePage(lastPage)" class="waves-effect"><a><i class="material-icons">chevron_left</i></a></li></ng-template>
            <li *ngFor="let page of pages" (click)="chargePage(page.number)" class="waves-effect" [ngClass]="page.state">
              <a>{{page.number}}</a></li>
            <div *ngIf="actualPage==pagelimit; then chevron_rightDisableBlock; else chevron_rightEnableBlock"></div>
            <ng-template #chevron_rightDisableBlock><li class="waves-effect disabled"><a><i class="material-icons">chevron_right</i></a></li></ng-template>
            <ng-template #chevron_rightEnableBlock><li (click)="chargePage(nextPage)" class="waves-effect"><a><i class="material-icons">chevron_right</i></a></li></ng-template>
          </ul>
        </div>
      </div>
    </ng-template>
    <!-- error for get clients data -->
    <ng-template [ngIf]="shiftsData.error">
      <div class="col l6 offset-l3 center">
        <div class="card-panel">
          <i class="material-icons large amber-text">sentiment_dissatisfied</i>
          <h3>No se encuentran los turnos</h3>
          <p>No hay ningun turno ingresado. Se sugiere que ingrese alguno.</p>
        </div>
      </div>
    </ng-template>
    <!-- loading for get clients data -->
    <ng-template [ngIf]="shiftsData.loading">
      <div class="row center">
        <div class="row"></div>
        <div class="row"></div>
        <div class="row"></div>
        <div class="row"></div>
        <div class="row"></div>
        <div class="row"></div>
        <div class="row"></div>
        <div class="row"></div>
        <div class="row"></div>
        <div class="row"></div>
        <div class="preloader-wrapper big active">
          <div class="spinner-layer spinner-blue-only">
            <div class="circle-clipper left">
              <div class="circle"></div>
            </div>
            <div class="gap-patch">
              <div class="circle"></div>
            </div>
            <div class="circle-clipper right">
              <div class="circle"></div>
            </div>
          </div>
        </div>
      </div>
    </ng-template>
  </div>
</div>
<div class="fixed-action-btn">
  <a class="btn-floating btn-large tooltipped hs-color" materialize="tooltip" routerLink="/dashboard/createShift"
    data-position="left" data-delay="50" data-tooltip="Crear turno">
    <i class="large material-icons">add</i>
  </a>
</div>

  <!-- Modal Structure Guards -->
<div id="modal" class="modal modal-fixed-footer" materialize="modal" [materializeParams]="[{dismissible: false}]" [materializeActions]="modalActions">
  <nav id="modal_nav" class="row hs-color">
    <div class="col m11 no-margin">
      <ul>
        <li><div class="valign-wrapper"><i class="material-icons">security</i><h5>Guardias</h5></div></li>
      </ul>
    </div>
    <div >
      <ul>
        <li ><a class="modal-close waves-effect waves-blue"><i class="material-icons">close</i></a></li>
        <li></li>
      </ul>
    </div>
  </nav>
  <div class="modal-content">
    <div class="row">
      <div *ngFor="let guard of guardsShiftSelected">
        <div class="col m7 offset-m3">
          <div class="card horizontal hoverable">
            <div class="card-image center ">
                <img class="image-guard " src="../../../assets/imgs/Police Officer1_RF_RMPL-01.png">
            </div>
            <div class="card-stacked ">
              <div class="card-content">
                <div>
                  <div class="valign-wrapper"><i class="material-icons ">person</i>{{(guard.firstname || '') + ' ' + (guard.lastname || '')}}</div>
                  <div class="valign-wrapper"><i class="material-icons ">subtitles</i>{{ guard.rut }}</div>
                  <div class="valign-wrapper"><i class="material-icons ">local_phone</i>{{ guard.phone }}</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <a class="modal-close waves-effect waves-blue btn-flat">Cerrar</a>
  </div>
</div>
  <!-- Modal Structure News -->
<div id="modal2" class="modal modal-fixed-footer" materialize="modal" [materializeParams]="[{dismissible: false}]" [materializeActions]="modalNewsActions">
  <nav id="modal_nav" class="row hs-color">
    <div class="col m11 no-margin">
      <ul>
        <li><div class="valign-wrapper"><i class="material-icons">assignment</i><h5>Novedades</h5></div></li>
      </ul>
    </div>
    <div >
      <ul>
        <li ><a class="modal-close waves-effect waves-blue"><i class="material-icons">close</i></a></li>
        <li></li>
      </ul>
    </div>
  </nav>
  <div class="modal-content">
    <!-- <pre>{{ newsShiftSelected | json }}</pre> -->
    <table class="striped">
      <thead class="hs-color">
        <tr>
          <th class="white-text">Título</th>
          <th class="white-text max-width">Descripción</th>
        </tr>
      </thead>

      <tbody >
        <tr *ngFor="let new of newsShiftSelected">
          <!-- <pre>{{ shift | json }}</pre> -->
          <td>{{(new.title || 'Sin titulo')}}</td>
          <td class="max-width">{{(new.description || 'Sin descripción')}}</td>         

        </tr>
      </tbody>
    </table>

  </div>
  <div class="modal-footer">
    <a class="modal-close waves-effect waves-blue btn-flat">Cerrar</a>
  </div>
</div>
  <!-- Modal Structure Visits -->
<div id="modal3" class="modal modal-fixed-footer" materialize="modal" [materializeParams]="[{dismissible: false}]" [materializeActions]="modalVisitsActions">
  <nav id="modal_nav" class="row hs-color">
    <div class="col m11 no-margin">
      <ul>
        <li><div class="valign-wrapper"><i class="material-icons">directions_walk</i><h5>Visitas</h5></div></li>
      </ul>
    </div>
    <div >
      <ul>
        <li ><a class="modal-close waves-effect waves-blue"><i class="material-icons">close</i></a></li>
        <li></li>
      </ul>
    </div>
  </nav>
  <div class="modal-content">
    <!-- <pre>{{ newsShiftSelected | json }}</pre> -->
    <table class="striped">
      <thead class="hs-color">
        <tr>
          <th class="white-text">Nombre</th>
          <!-- <th class="white-text max-width">Descripción</th> -->
          <th class="white-text">Rut</th>
          <th class="white-text">Patente</th>
          <th class="white-text">Entrada</th>
          <th class="white-text">Salida</th>
        </tr>
      </thead>

      <tbody >
        <tr *ngFor="let visit of visitsShiftSelected">
          <!-- <pre>{{ shift | json }}</pre> -->
          <td>{{(visit.name || 'Sin registrar')}}</td>
          <!-- <td class="max-width">{{(visit.patent || 'Sin descripción')}}</td>          -->
          <td>{{(visit.rut || 'Sin registrar')}}</td>         
          <td>{{(visit.patent || 'Sin registrar')}}</td>         
          <td>{{(visit.in || 'Sin registrar')}}</td>         
          <td>{{(visit.out || 'Sin registrar')}}</td>         

        </tr>
      </tbody>
    </table>

  </div>
  <div class="modal-footer">
    <a class="modal-close waves-effect waves-blue btn-flat">Cerrar</a>
  </div>
</div>
